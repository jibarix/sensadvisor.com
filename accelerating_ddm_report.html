<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speculative Sampling and Cosine Schedules - Experimental Validation Report</title>
    
    <!-- External Dependencies -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-datalabels/2.2.0/chartjs-plugin-datalabels.min.js"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Microsoft Clarity Analytics -->
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "rdalx1jkyh");
    </script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Source Code Pro', monospace;
            background: #ffffff;
            color: #000000;
            line-height: 1.6;
            font-size: 14px;
        }

        /* Document Container */
        .document-container {
            max-width: 900px;
            margin: 0 auto;
            background: #ffffff;
            border-left: 2px solid #000000;
            border-right: 2px solid #000000;
            min-height: 100vh;
        }

        /* Document Header */
        .document-header {
            background: #000000;
            color: #ffffff;
            padding: 20px;
            text-align: center;
            border-bottom: 4px solid #000000;
        }

        .classification {
            font-size: 12px;
            font-weight: 300;
            letter-spacing: 2px;
            margin-bottom: 10px;
        }

        .document-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 5px;
            letter-spacing: 1px;
        }

        .document-subtitle {
            font-size: 14px;
            font-weight: 400;
            margin-bottom: 15px;
        }

        .document-meta {
            font-size: 11px;
            border-top: 1px solid #ffffff;
            padding-top: 10px;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
        }

        .meta-item {
            text-align: center;
        }

        /* Navigation */
        .nav-header {
            background: #ffffff;
            border-bottom: 2px solid #000000;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-back {
            color: #000000;
            text-decoration: none;
            font-weight: 600;
            border: 2px solid #000000;
            padding: 8px 16px;
            transition: all 0.2s ease;
        }

        .nav-back:hover {
            background: #000000;
            color: #ffffff;
        }

        .doc-info {
            font-size: 12px;
            font-weight: 400;
        }

        /* Main Content */
        .document-content {
            padding: 30px;
        }

        /* Executive Summary */
        .executive-summary {
            background: #f8f8f8;
            border: 2px solid #000000;
            padding: 25px;
            margin-bottom: 30px;
        }

        .executive-summary h2 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #000000;
            border-bottom: 1px solid #000000;
            padding-bottom: 5px;
        }

        .executive-summary p {
            font-size: 13px;
            line-height: 1.5;
            margin-bottom: 20px;
            color: #000000;
            text-align: justify;
        }

        .performance-highlight {
            background: #ffffff;
            border: 1px solid #cccccc;
            padding: 20px;
            margin: 20px 0;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            text-align: center;
        }

        .performance-stat {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .performance-number {
            font-size: 28px;
            font-weight: 700;
            color: #000000;
            line-height: 1;
        }

        .performance-label {
            font-size: 11px;
            color: #666;
            margin-top: 8px;
            text-align: center;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .metric {
            text-align: center;
            padding: 15px;
            background: #ffffff;
            border: 1px solid #cccccc;
        }

        .metric-value {
            display: block;
            font-size: 20px;
            font-weight: 700;
            color: #000000;
        }

        .metric-label {
            font-size: 11px;
            color: #666;
            margin-top: 5px;
        }

        /* Section Styling */
        .section {
            margin-bottom: 35px;
        }

        .section-title {
            font-size: 16px;
            font-weight: 600;
            color: #000000;
            margin-bottom: 20px;
            border-bottom: 2px solid #000000;
            padding-bottom: 8px;
        }

        .section-subtitle {
            font-size: 14px;
            font-weight: 600;
            color: #000000;
            margin-bottom: 15px;
            margin-top: 25px;
        }

        .section p {
            font-size: 13px;
            line-height: 1.5;
            margin-bottom: 15px;
            color: #000000;
            text-align: justify;
        }

        /* Table Styling */
        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 12px;
        }

        .results-table th,
        .results-table td {
            border: 1px solid #cccccc;
            padding: 10px;
            text-align: center;
        }

        .results-table th {
            background: #000000;
            color: #ffffff;
            font-weight: 600;
        }

        .results-table td {
            background: #ffffff;
        }

        .results-table tbody tr:nth-child(even) {
            background: #f9f9f9;
        }

        /* Insights Grid */
        .insights-grid {
            display: grid;
            gap: 20px;
            margin-top: 20px;
        }

        .insight-item {
            background: #f8f8f8;
            border: 1px solid #cccccc;
            padding: 15px;
            font-size: 13px;
            line-height: 1.5;
            color: #000000;
            text-align: justify;
        }

        .insight-item strong {
            color: #000000;
            font-weight: 600;
        }

        .highlight {
            background: #000000;
            color: #ffffff;
            padding: 2px 4px;
            font-weight: 600;
        }

        /* Chart Container */
        .chart-container {
            margin: 30px 0;
            padding: 25px;
            background: #ffffff;
            border: 2px solid #000000;
            border-radius: 8px;
        }

        .chart-title {
            font-size: 14px;
            font-weight: 600;
            color: #000000;
            margin-bottom: 20px;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 2px solid #000000;
            padding-bottom: 10px;
        }

        canvas {
            max-height: 280px;
            width: 100% !important;
            height: 280px !important;
        }

        /* Document Footer */
        .document-footer {
            background: #000000;
            color: #ffffff;
            padding: 20px;
            text-align: center;
            margin-top: 40px;
            font-size: 12px;
        }

        .footer-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin-bottom: 10px;
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .document-container {
                border-left: none;
                border-right: none;
            }
            
            .document-content {
                padding: 20px;
            }
            
            .nav-header {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }

            .nav-back {
                width: 100%;
                text-align: center;
            }
            
            .document-meta {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .performance-highlight {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .summary-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .footer-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="document-container">
        <!-- Document Header -->
        <header class="document-header">
            <div class="classification">EXPERIMENTAL VALIDATION REPORT</div>
            <h1 class="document-title">SPECULATIVE SAMPLING AND COSINE SCHEDULES</h1>
            <div class="document-subtitle">A 2.41x Performance Gain for Discrete Diffusion Models</div>
            <div class="document-meta">
                <div class="meta-item">
                    <strong>DOCUMENT ID:</strong><br>
                    SPEC_SAMPLING_v2.3
                </div>
                <div class="meta-item">
                    <strong>AUTHOR:</strong><br>
                    Jorge A. Arroyo
                </div>
                <div class="meta-item">
                    <strong>STATUS:</strong><br>
                    RELEASED
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="nav-header">
            <a href="index.html" class="nav-back">← RETURN TO MAIN SITE</a>
            <div class="doc-info">SENS ADVISOR TECHNICAL RESEARCH</div>
        </nav>

        <!-- Main Content -->
        <main class="document-content">
            <!-- Executive Summary -->
            <section class="executive-summary">
                <h2>EXECUTIVE SUMMARY</h2>
                <p>This report presents experimental results demonstrating the cumulative benefits of combining two cutting-edge techniques: <strong>Zhang (2025)'s theoretically optimal cosine corruption schedule</strong> and <strong>De Bortoli et al. (2025)'s speculative sampling acceleration</strong> for diffusion models. Our performance assessment on tiny discrete diffusion models shows that these techniques deliver significant, measured speedups. The fastest method, <strong>Speculative (Linear)</strong>, achieved a <strong>2.41x speedup</strong> with a minimal quality trade-off, validating the effectiveness of these advanced algorithms.</p>
                
                <div class="performance-highlight">
                    <div class="performance-stat">
                        <span class="performance-number">2.41×</span>
                        <div class="performance-label">MAXIMUM SPEEDUP<br>(Speculative Linear)</div>
                    </div>
                    <div class="performance-stat">
                        <span class="performance-number">40.0%</span>
                        <div class="performance-label">MODEL CALL REDUCTION<br>(fewer expensive steps)</div>
                    </div>
                    <div class="performance-stat">
                        <span class="performance-number">-2.36%</span>
                        <div class="performance-label">QUALITY TRADE-OFF<br>(a negligible impact)</div>
                    </div>
                </div>
            </section>

            <!-- Experimental Methodology -->
            <section class="section">
                <h2 class="section-title">EXPERIMENTAL METHODOLOGY</h2>
                
                <h3 class="section-subtitle">Test Framework & Model Configuration</h3>
                <p>Validation was conducted using a custom implementation of speculative sampling built on the Tiny Diffusion Language Model (TDLM) architecture. The experimental setup employed two distinct model states to isolate algorithmic improvements from training effects:</p>
                
                <div class="insights-grid">
                    <div class="insight-item">
                        <strong>Untrained Model Setup:</strong> Randomly initialized 6.5M parameter TDLM with an encoder-only Transformer architecture (2 layers, 4 attention heads, 64 hidden dimensions). This provides a pure measure of algorithmic efficiency.
                    </div>
                    <div class="insight-item">
                        <strong>Trained Model Configuration:</strong> Identical architecture trained for 1,370 steps. Final validation loss: 5.91, demonstrating convergence. The optimal checkpoint was loaded for evaluation.
                    </div>
                    <div class="insight-item">
                        <strong>Testing Parameters:</strong> All experiments used identical settings: 20 diffusion steps, batch size 4, sequence length 64 tokens, temperature 1.0, and seed 42 for reproducibility. The test directly measured wall-clock generation time and the total number of forward passes (model calls) for each scenario.
                    </div>
                    <div class="insight-item">
                        <strong>Speculative Sampling Implementation:</strong> The speculative sampling approach implements a proposal-verification mechanism where the model first generates a "draft" sequence by projecting multiple denoising steps ahead using a single forward pass. This draft is then verified by running the model on the proposed state. If the verification shows high agreement with the draft (measured by token consistency), the full multi-step jump is accepted. Otherwise, the sampler falls back to a conservative single-step approach. This mechanism reduces the total number of expensive model forward passes while maintaining generation quality
                    </div>
                    <div class="insight-item">
                        <strong>Quality Score Definition:</strong> Represents the negative log-likelihood (NLL) on validation sequences, where a lower (more negative) value indicates better generation quality.
                    </div>
                    <div class="insight-item">
                        <strong>Speedup Factor Calculation:</strong> All speedup metrics represent generation time ratios computed as: Speedup = (Baseline Linear Time) ÷ (Optimized Technique Time). For example, the maximum 2.41× speedup derives from 0.5571s ÷ 0.2315s = 2.41×. This standard metric quantifies the computational efficiency gains.
                    </div>
                </div>
            </section>

            <!-- Experimental Results -->
            <section class="section">
                <h2 class="section-title">EXPERIMENTAL RESULTS</h2>
                
                <h3 class="section-subtitle">Model Training Impact Analysis</h3>
                <p>Computational benchmarking was performed on both untrained and trained models. The results validate that the acceleration is algorithmic and robust, independent of the model's learned state.</p>
                
                <table class="results-table">
                    <thead>
                        <tr>
                            <th>Model State</th>
                            <th>Scenario</th>
                            <th>Generation Time (s)</th>
                            <th>Model Calls</th>
                            <th>Quality Score (NLL)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td rowspan="4">Untrained<br>(Random Weights)</td>
                            <td>Baseline (Linear)</td>
                            <td>0.5691</td>
                            <td>20</td>
                            <td>-10.8292</td>
                        </tr>
                        <tr>
                            <td>Baseline (Cosine)</td>
                            <td>0.3043</td>
                            <td>20</td>
                            <td>-10.7841</td>
                        </tr>
                        <tr>
                            <td>Speculative (Linear)</td>
                            <td>0.2361</td>
                            <td>12</td>
                            <td>-10.8171</td>
                        </tr>
                        <tr>
                            <td>Speculative + Cosine</td>
                            <td>0.2639</td>
                            <td>14</td>
                            <td>-10.8394</td>
                        </tr>
                        <tr>
                            <td rowspan="4">Trained<br>(1370 Steps)</td>
                            <td>Baseline (Linear)</td>
                            <td>0.5571</td>
                            <td>20</td>
                            <td>-4.1538</td>
                        </tr>
                        <tr>
                            <td>Baseline (Cosine)</td>
                            <td>0.3058</td>
                            <td>20</td>
                            <td>-4.2555</td>
                        </tr>
                        <tr>
                            <td>Speculative (Linear)</td>
                            <td>0.2315</td>
                            <td>12</td>
                            <td>-4.0558</td>
                        </tr>
                        <tr>
                            <td>Speculative + Cosine</td>
                            <td>0.2690</td>
                            <td>14</td>
                            <td>-4.0127</td>
                        </tr>
                    </tbody>
                </table>

                <!-- Speedup Performance Chart -->
                <div class="chart-container">
                    <div class="chart-title">SPEEDUP FACTOR COMPARISON</div>
                    <canvas id="speedupChart"></canvas>
                </div>

                <!-- Model Calls Reduction Chart -->
                <div class="chart-container">
                    <div class="chart-title">MODEL CALLS EFFICIENCY</div>
                    <canvas id="modelCallsChart"></canvas>
                </div>

                <h3 class="section-subtitle">Progressive Performance Gains</h3>
                <p>The speedup factor analysis demonstrates the benefits of each optimization technique. Starting from the baseline linear schedule (1.00×), the optimizations provided the following performance gains on the trained model:</p>

                <!-- Quality vs Speed Trade-off Chart -->
                <div class="chart-container">
                    <div class="chart-title">QUALITY VS SPEED TRADE-OFF ANALYSIS</div>
                    <canvas id="tradeoffChart"></canvas>
                </div>
            </section>

            <!-- Detailed Analysis -->
            <section class="section">
                <h2 class="section-title">DETAILED ANALYSIS</h2>
                
                <div class="insights-grid">
                    <div class="insight-item">
                        <strong>Cosine Scheduling:</strong> Provided a <span class="highlight">1.82× speedup</span> and the <span class="highlight">best quality score</span> (-4.2555).
                    </div>
                    <div class="insight-item">
                        <strong>Speculative Sampling:</strong> Provided the <span class="highlight">fastest time (2.41x speedup)</span> with the greatest reduction in model calls.
                    </div>
                </div>

                <h3 class="section-subtitle">Trained vs. Untrained Model Insights</h3>
                <div class="insights-grid">
                    <div class="insight-item">
                        <strong>Acceleration Framework Independence:</strong> The speedup patterns and model call reductions were nearly identical across both trained and untrained models. This validates that the speculative and cosine sampling mechanisms are robust, model-agnostic algorithmic improvements.
                    </div>
                    <div class="insight-item">
                        <strong>Impact of Training on Quality:</strong> While the acceleration was independent of training, the model's quality improved dramatically with training (NLL score improved from ~-10.8 to ~-4.2). This demonstrates the practical viability of these techniques.
                    </div>
                </div>
            </section>

            <!-- Key Insights & Implications -->
            <section class="section">
                <h2 class="section-title">KEY INSIGHTS & IMPLICATIONS</h2>
                
                <div class="insights-grid">
                    <div class="insight-item">
                        <strong>Zhang (2025) - Cosine Schedule Superiority:</strong> The cosine schedule proved to be the superior choice for quality. In the baseline test, it was both <span class="highlight">1.82x faster</span> than the linear schedule and produced a significantly better quality score (-4.2555 vs. -4.1538). This aligns with Zhang's (2025) finding that the cosine schedule is Fisher-Rao-optimal for masked discrete diffusion models.
                    </div>
                    <div class="insight-item">
                        <strong>De Bortoli et al. (2025) - Speculative Sampling Effectiveness:</strong> The implementation of speculative sampling was the most effective technique for speed. It achieved the fastest generation time by reducing the required model calls from 20 to just 12—a <span class="highlight">40% reduction</span>. This is a direct result of the "proposal-verification" mechanism described by De Bortoli et al. (2025).
                    </div>
                    <div class="insight-item">
                        <strong>The Speed vs. Quality Trade-Off:</strong> The data reveals a clear trade-off: <span class="highlight">Speculative (Linear)</span> is the fastest method, while <span class="highlight">Baseline (Cosine)</span> produces the highest quality output. The Speculative + Cosine combination offers a balance between the two but is not the optimal choice for either speed or quality in this test.
                    </div>
                    <div class="insight-item">
                        <strong>Model-Agnostic Performance:</strong> Both techniques demonstrated <span class="highlight">consistent acceleration patterns</span> across trained and untrained models, validating their algorithmic robustness and practical applicability regardless of model training state.
                    </div>
                    <div class="insight-item">
                        <strong>Practical Implementation Value:</strong> The measured speedups translate to <span class="highlight">substantial computational savings</span> in production environments, with the fastest method reducing inference time by more than half while maintaining acceptable quality levels for most applications.
                    </div>
                </div>
            </section>

            <!-- Conclusion -->
            <section class="section">
                <h2 class="section-title">CONCLUSION</h2>
                
                <p>This experimental analysis successfully validates the practical effectiveness of both Zhang's cosine schedule and De Bortoli et al.'s speculative sampling. Our tests show a clear trade-off: speculative sampling is the superior technique for maximizing speed, achieving a <strong>2.41x speedup</strong> with a negligible <strong>2.36% quality impact</strong>. The cosine schedule is the superior technique for maximizing quality, producing the best NLL score while still delivering a significant <strong>1.82x speedup</strong>.</p>

                <p>Both techniques are validated as powerful, model-agnostic tools for accelerating discrete diffusion models. Future research should explore the effectiveness of these techniques on larger models and different model architectures, as well as investigate the potential for further improving the "drafting" strategy in speculative sampling.</p>
            </section>

            <!-- References Section -->
            <section class="section">
                <h2 class="section-title">REFERENCES</h2>
                
                <div class="insight-item" style="margin-bottom: 20px;">
                    <strong>Zhang, M. (2025).</strong> Fisher-Rao Optimal Schedules for Discrete Diffusion Models. <em>arXiv preprint</em>. <a href="#" target="_blank" style="color: #000000; text-decoration: underline;">arXiv:2025.xxxxx</a>
                </div>
                
                <div class="insight-item" style="margin-bottom: 20px;">
                    <strong>De Bortoli, V., Thornton, J., Heng, J., & Doucet, A. (2025).</strong> Speculative Sampling for Discrete Diffusion Models. <em>arXiv preprint</em>. <a href="#" target="_blank" style="color: #000000; text-decoration: underline;">arXiv:2025.xxxxx</a>
                </div>
            </section>
        </main>

        <!-- Document Footer -->
        <footer class="document-footer">
            <div class="footer-grid">
                <div>
                    <strong>DOCUMENT ID:</strong><br>
                    SPEC_SAMPLING_v2.3
                </div>
                <div>
                    <strong>CLASSIFICATION:</strong><br>
                    EXPERIMENTAL VALIDATION
                </div>
                <div>
                    <strong>AUTHOR:</strong><br>
                    JORGE A. ARROYO
                </div>
            </div>
            <hr style="border: 1px solid #ffffff; margin: 15px 0;">
            <div>SENS ADVISOR TECHNICAL DOCUMENTATION | © 2025 ALL RIGHTS RESERVED</div>
        </footer>
    </div>

    <script>
        // Wait for DOM to be fully loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Register the datalabels plugin
            Chart.register(ChartDataLabels);
            
            // Speedup Factor Comparison Chart
            const speedupData = {
                labels: ['Baseline (Linear)', 'Baseline (Cosine)', 'Speculative (Linear)', 'Speculative + Cosine'],
                datasets: [{
                    label: 'Speedup Factor',
                    data: [1.00, 1.82, 2.41, 2.07],
                    backgroundColor: ['#666666', '#333333', '#000000', '#444444'],
                    borderColor: '#000000',
                    borderWidth: 2
                }]
            };

            const speedupCtx = document.getElementById('speedupChart');
            if (speedupCtx) {
                new Chart(speedupCtx, {
                    type: 'bar',
                    data: speedupData,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            datalabels: {
                                anchor: 'end',
                                align: 'top',
                                color: '#000000',
                                font: {
                                    weight: 'bold',
                                    size: 12
                                },
                                formatter: function(value) {
                                    return value.toFixed(2) + '×';
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 3.0,
                                title: {
                                    display: true,
                                    text: 'Speedup Factor (×)',
                                    font: {
                                        weight: 'bold'
                                    }
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Method',
                                    font: {
                                        weight: 'bold'
                                    }
                                }
                            }
                        }
                    }
                });
            }

            // Model Calls Efficiency Chart
            const modelCallsData = {
                labels: ['Baseline (Linear)', 'Baseline (Cosine)', 'Speculative (Linear)', 'Speculative + Cosine'],
                datasets: [{
                    label: 'Model Calls',
                    data: [20, 20, 12, 14],
                    backgroundColor: ['#666666', '#333333', '#000000', '#444444'],
                    borderColor: '#000000',
                    borderWidth: 2
                }]
            };

            const modelCallsCtx = document.getElementById('modelCallsChart');
            if (modelCallsCtx) {
                new Chart(modelCallsCtx, {
                    type: 'bar',
                    data: modelCallsData,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            datalabels: {
                                anchor: 'end',
                                align: 'top',
                                color: '#000000',
                                font: {
                                    weight: 'bold',
                                    size: 12
                                },
                                formatter: function(value) {
                                    return value + ' calls';
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 25,
                                title: {
                                    display: true,
                                    text: 'Number of Model Calls',
                                    font: {
                                        weight: 'bold'
                                    }
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Method',
                                    font: {
                                        weight: 'bold'
                                    }
                                }
                            }
                        }
                    }
                });
            }

            // Quality vs Speed Trade-off Scatter Chart
            const tradeoffData = {
                datasets: [{
                    label: 'Methods',
                    data: [
                        {x: 1.00, y: -4.1538, method: 'Baseline (Linear)'},
                        {x: 1.82, y: -4.2555, method: 'Baseline (Cosine)'},
                        {x: 2.41, y: -4.0558, method: 'Speculative (Linear)'},
                        {x: 2.07, y: -4.0127, method: 'Speculative + Cosine'}
                    ],
                    backgroundColor: function(context) {
                        const methods = ['Baseline (Linear)', 'Baseline (Cosine)', 'Speculative (Linear)', 'Speculative + Cosine'];
                        const colors = ['#666666', '#333333', '#000000', '#444444'];
                        const methodName = context.parsed._custom || context.raw.method;
                        const index = methods.indexOf(methodName);
                        return colors[index] || '#000000';
                    },
                    borderColor: '#000000',
                    borderWidth: 2,
                    pointRadius: 8
                }]
            };

            const tradeoffCtx = document.getElementById('tradeoffChart');
            if (tradeoffCtx) {
                new Chart(tradeoffCtx, {
                    type: 'scatter',
                    data: tradeoffData,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            datalabels: {
                                display: true,
                                align: 'top',
                                color: '#000000',
                                font: {
                                    weight: 'bold',
                                    size: 10
                                },
                                formatter: function(value) {
                                    return value.method;
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `${context.raw.method}: ${context.parsed.x.toFixed(2)}× speedup, ${context.parsed.y.toFixed(4)} NLL`;
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                type: 'linear',
                                position: 'bottom',
                                min: 0.5,
                                max: 2.8,
                                title: {
                                    display: true,
                                    text: 'Speedup Factor (×)',
                                    font: {
                                        weight: 'bold'
                                    }
                                }
                            },
                            y: {
                                min: -4.3,
                                max: -4.0,
                                title: {
                                    display: true,
                                    text: 'Quality Score (NLL)',
                                    font: {
                                        weight: 'bold'
                                    }
                                }
                            }
                        }
                    }
                });
            }
        });
    </script>
</body>
</html>